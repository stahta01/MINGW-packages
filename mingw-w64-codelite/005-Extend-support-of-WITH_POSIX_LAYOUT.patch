From 910d3bee28f31210dfb4cf0f47ab3139f08e6f0b Mon Sep 17 00:00:00 2001
From: Tim Stahlhut <stahta01@gmail.com>
Date: Mon, 27 Oct 2025 18:16:24 -0400
Subject: Extend support of WITH_POSIX_LAYOUT

---
 CMakeLists.txt                       | 7 +++++--
 LiteEditor/app.cpp                   | 8 ++++++++
 wxcrafter/src/wxgui_bitmaploader.cpp | 5 +++++
 3 files changed, 18 insertions(+), 2 deletions(-)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index 8d53c4e1e..a4131647e 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -344,10 +344,13 @@ if(MINGW)
   # MinGW
   if(WITH_POSIX_LAYOUT)
     set(MINGW_INSTALL_PLUGINS_DIR "${CMAKE_INSTALL_PREFIX}/lib/codelite")
+    set(MINGW_INSTALL_BIN "${CMAKE_INSTALL_PREFIX}/bin")
+    set(MINGW_INSTALL_RESOURCES_DIR "${CMAKE_INSTALL_PREFIX}/share/codelite")
   else()
     set(MINGW_INSTALL_PLUGINS_DIR "${CMAKE_INSTALL_PREFIX}/plugins")
+    set(MINGW_INSTALL_BIN "${CMAKE_INSTALL_PREFIX}")
+    set(MINGW_INSTALL_RESOURCES_DIR "${MINGW_INSTALL_BIN}")
   endif()
-  set(MINGW_INSTALL_BIN "${CMAKE_INSTALL_PREFIX}")
 endif()
 
 if(APPLE)
@@ -358,7 +361,7 @@ if(APPLE)
 elseif(MINGW)
   set(PLUGINS_DIR "${MINGW_INSTALL_PLUGINS_DIR}")
   set(CL_INSTALL_BIN "${MINGW_INSTALL_BIN}")
-  set(CL_RESOURCES_DIR "${MINGW_INSTALL_BIN}")
+  set(CL_RESOURCES_DIR "${MINGW_INSTALL_RESOURCES_DIR}")
 else()
   # /usr/lib/codelite
   set(PLUGINS_DIR "${CL_PREFIX}/${CL_INSTALL_LIBDIR}/codelite")
diff --git a/LiteEditor/app.cpp b/LiteEditor/app.cpp
index 6ed2752c4..94b047cd4 100644
--- a/LiteEditor/app.cpp
+++ b/LiteEditor/app.cpp
@@ -509,7 +509,15 @@ bool CodeLiteApp::OnInit()
         }
         homeDir = bd.GetPath();
     } else {
+#ifdef USE_POSIX_LAYOUT
+        wxFileName execfpath(clStandardPaths::Get().GetExecutablePath());
+        if (execfpath.GetDirs().Last().IsSameAs("bin")) {
+            execfpath.RemoveLastDir();
+        }
+        homeDir = execfpath.GetPath() + wxT("/share/codelite");
+#else
         homeDir = wxFileName(wxStandardPaths::Get().GetExecutablePath()).GetPath();
+#endif
     }
     clStandardPaths::Get().SetDataDir(homeDir);
 #endif
diff --git a/wxcrafter/src/wxgui_bitmaploader.cpp b/wxcrafter/src/wxgui_bitmaploader.cpp
index 17c70d930..9687f49af 100644
--- a/wxcrafter/src/wxgui_bitmaploader.cpp
+++ b/wxcrafter/src/wxgui_bitmaploader.cpp
@@ -14,7 +14,12 @@ wxCrafter::ResourceLoader::ResourceLoader(const wxString& skin)
 {
     if(m_bitmaps.empty()) {
         wxString zipFile;
+#ifdef USE_POSIX_LAYOUT
+        zipFile << wxStandardPaths::Get().GetDataDir() << wxT(INSTALL_DIR) << wxFileName::GetPathSeparator() << skin
+                << wxT(".zip");
+#else
         zipFile << wxStandardPaths::Get().GetDataDir() << wxFileName::GetPathSeparator() << skin << wxT(".zip");
+#endif
         clZipReader zip(zipFile);
 
         std::unordered_map<wxString, clZipReader::Entry> entries;
-- 
2.48.1.windows.1

